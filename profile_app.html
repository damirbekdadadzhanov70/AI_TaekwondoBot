<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è Taekwondo AI</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –Ω–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
        body {
            /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Telegram –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç–µ–º */
            background-color: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
            /* –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π —à—Ä–∏—Ñ—Ç –¥–ª—è –ª—É—á—à–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ */
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            padding: 20px;
            margin: 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
            /* –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –≤—ã—Å–æ—Ç—É –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ */
            min-height: 100vh;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        label {
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--tg-theme-hint-color, #aaa);
            font-size: 14px;
        }
        /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ */
        input[type="number"] {
            padding: 10px;
            border: 1px solid var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 8px;
            background-color: var(--tg-theme-secondary-bg-color, #f5f5f5);
            color: var(--tg-theme-text-color, #000);
            font-size: 16px;
            /* –£–±–∏—Ä–∞–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏ –≤ Chrome/Edge */
            -moz-appearance: textfield;
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
        h1 {
            color: var(--tg-theme-text-color, #000);
            font-size: 20px;
            margin-top: 0;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è —Å–ø–æ—Ä—Ç—Å–º–µ–Ω–∞</h1>

    <div class="form-group">
        <label for="age">–í–æ–∑—Ä–∞—Å—Ç, –ª–µ—Ç (–º–∏–Ω–∏–º—É–º 4)</label>
        <input type="number" id="age" placeholder="8">
    </div>

    <div class="form-group">
        <label for="height">–†–æ—Å—Ç, —Å–º (–º–∏–Ω–∏–º—É–º 80)</label>
        <input type="number" id="height" placeholder="130">
    </div>

    <div class="form-group">
        <label for="weight">–í–µ—Å, –∫–≥ (–º–∏–Ω–∏–º—É–º 15)</label>
        <input type="number" id="weight" placeholder="35.5">
    </div>

    <p style="font-size: 12px; color: var(--tg-theme-hint-color);">
        –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–∫—É –∏–ª–∏ –∑–∞–ø—è—Ç—É—é –¥–ª—è –¥—Ä–æ–±–Ω–æ–≥–æ –≤–µ—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 35.5 –∏–ª–∏ 35,5).
    </p>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Mini App
        Telegram.WebApp.ready();

        const mainButton = Telegram.WebApp.MainButton;

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥", –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å –æ–∫–Ω–æ
        Telegram.WebApp.BackButton.show();
        Telegram.WebApp.BackButton.onClick(function() {
            // –†—É—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞
            Telegram.WebApp.close();
        });


        function validateAndSend() {
            const age = document.getElementById('age').value.trim();
            const height = document.getElementById('height').value.trim();
            const weight = document.getElementById('weight').value.trim();

            if (!age || !height || !weight) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ Telegram
                Telegram.WebApp.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }

            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤–µ—Å, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫—É –∫–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
            const sanitizedWeight = weight.replace(',', '.');

            const data = {
                // parseInt –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç –∏ —Ä–æ—Å—Ç –≤ —Ü–µ–ª—ã–µ —á–∏—Å–ª–∞
                age: parseInt(age),
                height: parseInt(height),
                // parseFloat –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–µ—Å –≤ –¥—Ä–æ–±–Ω–æ–µ —á–∏—Å–ª–æ
                weight: parseFloat(sanitizedWeight)
            };

            // --- –í–∞–ª–∏–¥–∞—Ü–∏—è ---

            // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø–∞—Ä—Å–∏–Ω–≥ –Ω–µ –≤–µ—Ä–Ω—É–ª NaN –∏ —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ä–∞–∑—É–º–Ω–æ–≥–æ
            if (isNaN(data.age) || isNaN(data.height) || isNaN(data.weight) ||
                data.age < 4 || data.height < 80 || data.weight < 15) {

                Telegram.WebApp.showAlert('–í–≤–µ–¥–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è! –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —á–∏—Å–ª–∞.');
                return;
            }

            // --- –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö ---

            mainButton.showProgress(true); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º JSON-—Å—Ç—Ä–æ–∫—É —Å –¥–∞–Ω–Ω—ã–º–∏ –±–æ—Ç—É
            Telegram.WebApp.sendData(JSON.stringify(data));

            // üí° –ö–õ–Æ–ß–ï–í–û–ï UX-–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:
            // –°–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—Ç–∏–≤–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ,
            // –Ω–æ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –æ—Å—Ç–∞—Ç—å—Å—è.
            setTimeout(() => {
                mainButton.hideProgress();
                Telegram.WebApp.HapticFeedback.notificationOccurred('success'); // –ü—Ä–∏—è—Ç–Ω—ã–π –≤–∏–±—Ä–æ-–æ—Ç–∫–ª–∏–∫

                Telegram.WebApp.showPopup({
                    title: '–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω',
                    message: '–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.',
                    buttons: [{ type: 'close', text: '–û–ö' }] // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –û–ö –∏ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –æ–∫–Ω–µ
                });

                // –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ –Ω–∞ "–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–ª–∞–Ω—É" –∏ —Ç.–ø.
                // mainButton.setText("‚ñ∂Ô∏è –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–ª–∞–Ω—É");

            }, 300); // 300–º—Å –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–ª–∞–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ Telegram
        mainButton.setText("–°–û–•–†–ê–ù–ò–¢–¨ –ü–†–û–§–ò–õ–¨");
        mainButton.onClick(validateAndSend);
        mainButton.show();
    </script>
</body>
</html>